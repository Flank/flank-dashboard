@startuml deploy_command_sequence_diagram

skinparam ParticipantPadding 20
skinparam BoxPadding 10

actor Bob

box "Deploy Tool"
participant CLI
participant DeployCommand
participant FirebaseCommand
participant FlutterCommand
participant GCloudCommand
end box

Bob -> CLI ++ : run deploy command
CLI -> DeployCommand ++ : run()

DeployCommand -> GCloudCommand ++: login()
GCloudCommand -> CLI -- : execute login on gcloud
CLI -> Bob -- : requires gcloud login info
Bob -> CLI ++ : enters gcloud login info
DeployCommand -> GCloudCommand ++ : addProject()
return project ID

DeployCommand -> FirebaseCommand ++ : login()
FirebaseCommand --> DeployCommand : firebase token

DeployCommand -> FirebaseCommand : addFirebase(projectID, firebaseToken)
DeployCommand -> GCloudCommand : addProjectApp(region, projectID)
DeployCommand -> GCloudCommand : createDatabase(region, projectID)
DeployCommand -> FirebaseCommand : createWebApp(projectID, firebaseToken)

activate FirebaseCommand
FirebaseCommand --> DeployCommand : app ID
deactivate FirebaseCommand

DeployCommand -> DeployCommand : _buildAndDeploy(appID, projectID, firebaseToken, repoURL, srcPath)
DeployCommand -> DeployCommand : cleanup(srcPath)
DeployCommand --> Terminal : terminate()
deactivate DeployCommand

Terminal --> Bob : deployment completed
deactivate Terminal

@enduml
