@startuml ci_integrations_config_validator_class_diagram

    package integration.interface {
        package base {
            package party {
                interface IntegrationParty<T extends Config, K extends IntegrationClient, V extends ConfigValidator> {
                    + clientFactory : IntegrationClientFactory<T, K>
                    + configParser : ConfigParser<T>
                    + configValidatorFactory : ConfigValidatorFactory<V>
                }
            }

            package config {
                package model {
                    interface Config {}

                    abstract class ConfigValidationResultBuilder<T extends ConfigValidationResult> {
                        - _authValidationResult : ConfigFieldValidationResult

                        + T build()
                        + void setAuthResult(ConfigFieldValidationConclusion conclusion, String additionalContext)
                        + ConfigFieldValidationResult buildFieldResult(ConfigFieldValidationConclusion conclusion, String additionalContext)
                    }

                    abstract class ConfigValidationResult<T extends Config> {
                        + authValidationResult : ConfigFieldValidationResult

                        + String toString()
                    }

                    enum ConfigFieldValidationConclusion {
                        + valid
                        + invalid
                        + unknown
                    }

                    class ConfigFieldValidationResult {
                        + conclusion : ConfigFieldValidationConclusion
                        + field : String
                        + additionalContext : String

                        + isSuccess : bool
                        + isFailure : bool
                        + isUnknown : bool

                        + ConfigFieldValidationResult.success(String field, String additionalContext)
                        + ConfigFieldValidationResult.failure(String field, String additionalContext)
                        + ConfigFieldValidationResult.unknown(String field, String additionalContext)
                        + String toString()

                        - ConfigValidationResult._(ConfigFieldValidationConclusion conclusion, String field, String additionalContext)
                    }
                }

                package validator {
                    abstract class ConfigValidator<T extends Config, V extends ValidationDelegate> {
                        + validationDelegate : V

                        + Future<ConfigValidationResult> validate(T config)
                    }
                }

                package validation_delegate as base_validation_delegate {
                    interface ValidationDelegate {
                        + Future<InteractionResult> validateAuth(AuthorizationBase auth)
                    }
                }

                package validator_factory {
                    interface ConfigValidatorFactory<V extends ConfigValidator> {
                        + V create()
                    }
                }
            }
        }
        
        package source.config {
            package validation_delegate as source_validation_delegate {
                interface SourceValidationDelegate {
                    + Future<InteractionResult> validateSourceProjectId(String sourceProjectId)
                }
            }

            package model as source_model {
                abstract class SourceConfigValidationResult {
                    + sourceProjectIdValidationResult : ConfigFieldValidationResult
                }

                abstract class SourceConfigValidationResultBuilder {
                    - _sourceProjectIdFieldValidationResult : ConfigFieldValidationResult

                    + void setSourceProjectIdResult(ConfigFieldValidationConclusion conclusion, String additionalContext)
                }
            }
        }

        package destination.config {
            package validation_delegate as destination_validation_delegate {
                interface DestinationValidationDelegate {
                    + Future<InteractionResult> validateDestinationProjectId(String destinationProjectId)
                }
            }

            package model as destination_model {
                abstract class DestinationConfigValidationResult {
                    + destinationProjectIdValidationResult : ConfigFieldValidationResult
                }

                abstract class DestinationConfigValidationResultBuilder {
                    - _destinationProjectIdFieldValidationResult : ConfigFieldValidationResult

                    + void setDestinationProjectIdResult(ConfigFieldValidationConclusion conclusion, String additionalContext)
                }
            }
        }
    }

    IntegrationParty --> ConfigValidatorFactory : uses

    ConfigValidatorFactory --> ConfigValidator : uses

    ConfigValidator --> ValidationDelegate : uses
    ConfigValidator --> ConfigValidationResult : uses
    ConfigValidator --> ConfigValidationResultBuilder : uses
    ConfigValidator --> Config : uses

    ConfigValidationResultBuilder -down-> ConfigValidationResult : builds
    ConfigValidationResultBuilder -down-> ConfigFieldValidationResult : uses

    ConfigValidationResult -down-> ConfigFieldValidationResult : uses

    ConfigFieldValidationResult -down-> ConfigFieldValidationConclusion : uses

    SourceValidationDelegate -up-|> ValidationDelegate
    DestinationValidationDelegate -down-|> ValidationDelegate

    SourceConfigValidationResult -up-|> ConfigValidationResult
    DestinationConfigValidationResult -down-|> ConfigValidationResult

    SourceConfigValidationResultBuilder -up-|> ConfigValidationResultBuilder
    DestinationConfigValidationResultBuilder -down-|> ConfigValidationResultBuilder

    ValidationDelegate -[hidden]down-> ConfigValidationResultBuilder

    DestinationValidationDelegate -[hidden]down-> DestinationConfigValidationResultBuilder
    SourceValidationDelegate -[hidden]down-> SourceConfigValidationResultBuilder
@enduml
