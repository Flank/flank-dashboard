@startuml github_actions_sequence_diagram

actor Bob

participant "Awesome Project Actions workflow" as AwesomeWorkflow
participant "Run tests job" as RunTests
participant "Build and publish job" as BuildAndPublish
participant "Notify about building the Awesome project" as NotifyBuilding

participant "Metrics Integration Actions workflow" as IntegrationsWorkflow
participant "Awesome project build data sync" as AwesomeSync
participant "CI Integrations" as CiIntegrations

database "Firestore Database" as Firestore


Bob -> AwesomeWorkflow : Push commit to master
activate AwesomeWorkflow
AwesomeWorkflow -> RunTests : Run tests
activate  RunTests
alt 
    RunTests --> AwesomeWorkflow : Tests failed
end 
return Test complete 
AwesomeWorkflow  -> BuildAndPublish : Run building and publishing job
activate BuildAndPublish
alt 
    BuildAndPublish --> AwesomeWorkflow : Publishing failed
end
return Building and publishinng finished
AwesomeWorkflow -> NotifyBuilding : Run notify about building project
activate NotifyBuilding
NotifyBuilding -> IntegrationsWorkflow : Notify about Awesome project is building
return Notification sent 
return Workflow run finished
activate IntegrationsWorkflow
IntegrationsWorkflow -> AwesomeSync : Run sync job
activate AwesomeSync
AwesomeSync -> AwesomeSync : Wait until Awesome Project Actions Workflow got finished
AwesomeSync -> CiIntegrations : Run sync command
activate CiIntegrations
CiIntegrations -> Firestore : Add new builds data
return Sync command finished
return Sync finished
IntegrationsWorkflow --> Bob : Sync finished

@enduml
